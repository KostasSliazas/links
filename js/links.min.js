!function(){const checkboxes=document.getElementById("check-boxes"),selection=document.getElementById("select"),choise=document.getElementById("choises"),createLink=document.getElementById("create-link"),outpus=document.getElementById("outpus"),closeEx=document.getElementById("exit"),closeBtn=document.getElementById("exit1"),opensBtn=document.getElementById("open"),adition=document.getElementById("aditions"),search=document.getElementById("site-search"),copyAll=document.getElementById("copy-links"),exportJson=document.getElementById("export-json"),showExport=document.getElementById("export-div"),links=document.getElementById("links"),found=document.getElementById("founded"),docfrag=document.createDocumentFragment(),checkeds=document.getElementsByName("check")[0],classSwich=()=>checkeds.checked?outpus.classList.add("checks"):outpus.classList.remove("checks");function showCheckboxes(e){if("create-link"!==e.target.id)if("select"!==e.target.id||selection.classList.contains("open")){if("LABEL"===e.target.tagName||"INPUT"===e.target.tagName)return;selection.classList.remove("open"),checkboxes.style.display="none",addTextOfChecked()}else selection.classList.add("open"),checkboxes.style.display="block"}function loopOverInputs(){const checked=[];return[...checkboxes.getElementsByTagName("INPUT")].forEach(e=>{e.checked&&checked.push(e.value)}),checked}function addTextOfChecked(m){choise.innerHTML=m||loopOverInputs().join(", ")}function hide(e){e.style.display="none"===e.style.display?"block":"none"}function setLinks(){const url=document.getElementById("urls").value;if(url.length>0){const fav=extractHostname(url),createLinkObject={text:adition.value,url:fav,full:url,type:loopOverInputs()};return createLinkObject}return addTextOfChecked("No URL defined"),!1}function addStorage(){if("localStorage"in window){if(setLinks()){const key=JSON.stringify(setLinks().full).slice(1,-1),data=JSON.stringify(setLinks());window.localStorage.setItem(key,data)}}else window.alert("no localStorage in window")}function extractHostname(url){let hostname;return hostname=url.indexOf("//")>-1?url.split("/")[2]:url.split("/")[0],hostname=hostname.split(":")[0],hostname=hostname.split("?")[0],hostname}function loopLocalStorage(){search.focus(),search.value="",outpus.innerHTML="",0===window.localStorage.length&&(outpus.innerHTML="No links added...");for(let i=0;i<window.localStorage.length;i++){const{url:url,type:type,full:full,text:text}=JSON.parse(window.localStorage.getItem(window.localStorage.key(i)));createElem(url,type,text,full)}outpus.appendChild(docfrag);const total=window.localStorage.length;found.innerHTML=total+"/"+total}function loopLocalStorageSearch(){outpus.innerHTML="";let count=0;for(let i=0,len=window.localStorage.length;i<len;i++){const{full:full,text:text,type:type,url:url}=JSON.parse(window.localStorage.getItem(window.localStorage.key(i))),values=type.concat(text.split(),url.split()),isInarray=values.map(e=>!!e.toLowerCase().includes(search.value.toLowerCase()));isInarray.includes(!0)&&(count++,createElem(url,type,text,full))}outpus.appendChild(docfrag),found.innerHTML=count+"/"+window.localStorage.length,0===count&&(outpus.innerHTML="No results...")}function removeThis(){return window.localStorage.removeItem(this.href),loopLocalStorage(),!1}function createElem(url,type,text,full){const elems=document.createElement("a"),types=document.createElement("span"),texts=document.createElement("span"),urls=document.createElement("span"),close=document.createElement("span");close.className="close",close.innerHTML="Ã—",close.onclick=removeThis.bind(elems),elems.setAttribute("href",full),elems.setAttribute("target","_blank"),types.textContent=type,urls.textContent=url,texts.textContent=text,urls.className="urls",elems.appendChild(urls),elems.appendChild(texts),elems.appendChild(types),elems.appendChild(close),docfrag.appendChild(elems)}checkeds.checked=!1,checkeds.addEventListener("input",classSwich),search.addEventListener("keydown",event=>{if("Enter"===event.key&&event.target.value.length>0)event.preventDefault(),loopLocalStorageSearch();else{if("Backspace"!==event.key||0!==event.target.value.length)return!1;found.innerHTML="",loopLocalStorage()}}),search.addEventListener("input",event=>{event.target.value.length>=0&&loopLocalStorageSearch()}),copyAll.addEventListener("click",e=>{const data=document.getElementById("export");if(hide(showExport),data.value.length>0)return!1;data.value="var data = JSON.parse("+JSON.stringify(JSON.stringify(window.localStorage))+");Object.keys(data).forEach(function (k) {localStorage.setItem(k, data[k]);});"});const saveData=function(){const a=document.createElement("a");return function(data,fileName){const json=JSON.stringify(data),blob=new window.Blob([json],{type:"octet/stream"}),url=window.URL.createObjectURL(blob);a.href=url,a.download=fileName,a.click(),window.URL.revokeObjectURL(url)}}(),fileName=`localStorage${dateGet()}.json`;function dateGet(){const dateObj=new Date,month=dateObj.getUTCMonth()+1,day=dateObj.getUTCDate(),year=dateObj.getUTCFullYear();return year+"/"+month+"/"+day}function loopStorageItems(){const data=[];for(let i=0;i<window.localStorage.length;i++)data.push(JSON.parse(window.localStorage.getItem(window.localStorage.key(i))));return data}createLink.addEventListener("click",()=>{addStorage(),loopLocalStorage()}),exportJson.addEventListener("click",()=>saveData(loopStorageItems(),fileName)),document.addEventListener("dblclick",loopLocalStorage),document.addEventListener("click",showCheckboxes),closeEx.addEventListener("click",()=>hide(showExport)),closeBtn.addEventListener("click",()=>hide(links)),opensBtn.addEventListener("click",()=>hide(links)),addTextOfChecked(),loopLocalStorage()}();