const checkboxes=document.getElementById("check-boxes"),selection=document.getElementById("select"),choise=document.getElementById("choises"),createLink=document.getElementById("create-link"),outpus=document.getElementById("outpus"),closeEx=document.getElementsByClassName("close-ex")[0],closeBtn=document.getElementsByClassName("close")[0],opensBtn=document.getElementById("open"),adition=document.getElementById("aditions"),search=document.getElementById("site-search"),copyAll=document.getElementById("copy-links"),showExport=document.getElementById("export-div"),links=document.getElementById("links");function showCheckboxes(e){if(addTextOfChecked(),"select"!==e.target.id||selection.classList.contains("open")){if("LABEL"===e.target.tagName||"INPUT"===e.target.tagName)return;selection.classList.remove("open"),checkboxes.style.display="none"}else selection.classList.add("open"),checkboxes.style.display="block"}function loopOverInputs(){let checked=[];return[...checkboxes.getElementsByTagName("INPUT")].forEach(e=>{e.checked&&checked.push(e.value)}),checked}function addTextOfChecked(){choise.innerHTML=loopOverInputs().join(", ")}function setLinks(){const url=document.getElementById("urls").value;if(url.length>2){const fav=extractHostname(url),createLinkObject={text:adition.value,url:fav,full:url,type:loopOverInputs()};return createLinkObject}return!1}function addStorage(){if("localStorage"in window){if(setLinks()){var key=setLinks().url,data=JSON.stringify(setLinks());localStorage.setItem(key,data)}}else alert("no localStorage in window")}function extractHostname(url){var hostname;return hostname=(hostname=(hostname=url.indexOf("//")>-1?url.split("/")[2]:url.split("/")[0]).split(":")[0]).split("?")[0]}function loopLocalStorage(){0===localStorage.length&&(outpus.innerHTML="No results...");for(var i=0;i<localStorage.length;i++){let{url:url,type:type,full:full,text:text}=JSON.parse(localStorage.getItem(localStorage.key(i)));createElem(url,type,text,full)}}function hide(elem){"none"===elem.style.display?elem.style.display="block":elem.style.display="none"}function loopLocalStorageSearch(){outpus.innerHTML="";let count=0;for(let i=0;i<localStorage.length;i++){let{url:url,type:type,full:full,text:text}=JSON.parse(localStorage.getItem(localStorage.key(i))),dats=url;type.concat(text.split(),url.split()).forEach(e=>{e.toLowerCase().includes(search.value.toLowerCase())&&dats===url&&(createElem(url,type,text,full),count++,dats="")})}0===count&&(outpus.innerHTML="No results...")}function createElem(url,type,text,full){let elems=document.createElement("a"),types=document.createElement("span"),texts=document.createElement("span"),urls=document.createElement("span");elems.setAttribute("href",full),elems.setAttribute("target","_blank"),types.textContent=type,urls.textContent=url,texts.textContent=text,urls.className="urls",elems.appendChild(urls),elems.appendChild(texts),elems.appendChild(types),outpus.appendChild(elems)}search.addEventListener("keydown",e=>{"Enter"===event.key&&event.target.value.length>2?(event.preventDefault(),loopLocalStorageSearch()):"Backspace"===event.key&&0===event.target.value.length&&(outpus.innerHTML="",loopLocalStorage())}),search.addEventListener("input",e=>{event.target.value.length>2&&loopLocalStorageSearch()}),copyAll.addEventListener("click",e=>{const data=document.getElementById("export");hide(showExport),data.value.length>0||(data.value="var data = JSON.parse("+JSON.stringify(JSON.stringify(localStorage))+");Object.keys(data).forEach(function (k) {localStorage.setItem(k, data[k]);});")}),createLink.addEventListener("click",()=>addStorage(),outpus.innerHTML="",loopLocalStorage),document.addEventListener("click",showCheckboxes),closeEx.addEventListener("click",()=>hide(showExport)),closeBtn.addEventListener("click",()=>hide(links)),opensBtn.addEventListener("click",()=>hide(links)),addTextOfChecked(),loopLocalStorage(),search.focus();