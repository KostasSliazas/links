!function(w,d){const StorageNamespace={namespace:"localStorageManager",setNamespace(ns){this.namespace=ns},_getKey(key){return`${this.namespace}:${key}`},setItem(key,value){w.localStorage.setItem(this._getKey(key),JSON.stringify(value))},getItem(key){const item=w.localStorage.getItem(this._getKey(key));if(null===item)return null;try{return JSON.parse(item)}catch(e){return console.error(`Error parsing JSON for key "${key}":`,e),null}},clear(){Object.keys(w.localStorage).forEach((key=>{key.startsWith(`${this.namespace}:`)&&w.localStorage.removeItem(key)}))},keys(){return Object.keys(w.localStorage).filter((key=>key.startsWith(`${this.namespace}:url`))).map((key=>key.replace(`${this.namespace}:url`,"")))},appendItem(key,value){const existingValue=this.getItem(key);if(Array.isArray(existingValue))existingValue.push(value),this.setItem(key,existingValue);else if(existingValue&&"object"==typeof existingValue)this.setItem(key,{...existingValue,...value});else{const newValue=Array.isArray(value)?value:[value];this.setItem(key,newValue)}},removeItem(key,index){const array=this.getItem(key);Array.isArray(array)&&array.length>index&&(array.splice(index,1),this.setItem(key,array))}},body=d.body,fileInput=d.getElementById("file-input"),checkboxes=d.getElementById("check-boxes"),selection=d.getElementById("select"),choice=d.getElementById("choices"),createLink=d.getElementById("create-link"),outputs=d.getElementById("output"),closeEx=d.getElementById("exit"),closeBtn=d.getElementById("exit1"),opensBtn=d.getElementById("open"),addition=d.getElementById("additions"),search=d.getElementById("site-search"),copyAll=d.getElementById("copy-links"),exportJson=d.getElementById("export-json"),showExport=d.getElementById("export-div"),links=d.getElementById("links"),found=d.getElementById("founded"),checkedBoxElement=d.getElementsByName("check")[0],filteredExport=d.getElementById("filter"),state=!!StorageNamespace.getItem("admin-mode");checkedBoxElement.checked=state,body.classList.toggle("checks",state);filteredExport.checked=!1;let lastElem=null,active=!1;const hide=element=>{lastElem&&lastElem!==element&&(lastElem.style.display="none",active=!1),element.style.display=active?"none":"block",active=!active,lastElem=element},counterObject={counter:StorageNamespace.getItem("url").length,array:[]},showStats=()=>{found.innerHTML=counterObject.array.filter((elem=>"hidden"!==elem.className)).length+"/"+StorageNamespace.getItem("url").length},addTextOfChecked=m=>{choice.innerHTML=m||loopOverInputs().join(", ")},loopOverInputs=()=>[...checkboxes.getElementsByTagName("INPUT")].map((e=>{if(e.checked)return e.value})).filter(Boolean);function loopStorageItems(){const data=[],urls=StorageNamespace.getItem("url");return urls&&"object"==typeof urls&&Object.values(urls).forEach((value=>{data.push(value)})),data}const exporter=()=>{const fileName=`localStorage${function(){const dateObj=new Date,month=(dateObj.getUTCMonth()+1).toString().length>1?dateObj.getUTCMonth()+1:"0"+(dateObj.getUTCMonth()+1),day=dateObj.getUTCDate().toString().length>1?dateObj.getUTCDate():"0"+dateObj.getUTCDate(),year=dateObj.getUTCFullYear(),sec=dateObj.getSeconds().toString().length>1?dateObj.getSeconds():"0"+dateObj.getSeconds(),minutes=dateObj.getMinutes().toString().length>1?dateObj.getMinutes():"0"+dateObj.getMinutes(),hours=dateObj.getHours().toString().length>1?dateObj.getHours():"0"+dateObj.getHours();return`${year}-${month}-${day}(${hours}-${minutes}-${sec})`}()}.json`;if(filteredExport.checked){const filteredLinks=Array.from(outputs.querySelectorAll("a:not(.hidden)")).map((element=>element.links));saveData(filteredLinks,`${search.value||"fil"}-${fileName}`)}else{const allLinks=loopStorageItems();saveData(allLinks,`all-${fileName}`)}hide(showExport)};const remover=function(e){e.preventDefault();const elem=this.element,index=counterObject.array.indexOf(elem);e.target.parentElement&&elem.remove(),index>=0&&(counterObject.array.splice(index,1),StorageNamespace.removeItem("url",index)),showStats()};function setLinks(){const urlInput=d.getElementById("urls"),url=urlInput.value.trim();if(0===url.length)return addTextOfChecked("No URL defined"),!1;if(StorageNamespace.getItem(url))return addTextOfChecked("Value already exists"),!1;const fav=function(url){try{return new URL(url).hostname.split(":")[0]}catch(error){return console.error("Invalid URL:",error.message),null}}(url),createLinkObject={text:addition.value,url:fav,full:url,type:loopOverInputs()},element=createElem(createLinkObject);return outputs.appendChild(element),StorageNamespace.appendItem("url",createLinkObject),counterObject.array.push(element),showStats(),urlInput.value="",!1}class DOMElements{constructor(elementTag,className,item,functions){this.element=d.createElement(elementTag),this.element.links=item,"string"==typeof elementTag&&this.switcher(elementTag),"string"==typeof className&&(this.element.className=className),functions&&"object"==typeof functions&&"close"===className&&(this.element.onclick=remover.bind(functions))}switcher(element){return this[element]()}span(){this.element.textContent=this.element.links}a(){const links=this.element.links;links&&links.full&&(this.element.setAttribute("target","_blank"),this.element.setAttribute("href",links.full))}img(){const links=this.element.links,image=new Image;links&&links.url&&(image.setAttribute("alt",`${links.url}-${adder.counter++}`),image.setAttribute("loading","lazy"),image.src=`https://${links.url}/favicon.ico`,image.width=16,image.height=16,image.onerror=function(e){e.target.onerror=null,e.target.src="./favicon.ico"}),this.element=image}}const adder={counter:0};function createElem(elms){if(!elms)return;const aElement=new DOMElements("a","link",elms,null);return[elms&&new DOMElements("img","img",elms,null),elms?.url&&new DOMElements("span","urls",elms.url,null),elms?.text&&new DOMElements("span","texts",elms.text,null),elms?.type&&new DOMElements("span","types",elms.type,null),aElement&&new DOMElements("span","close","Ã—",aElement)].filter(Boolean).forEach((childElement=>aElement.element.appendChild(childElement.element))),outputs.appendChild(aElement.element),aElement.element}function loopLocalStorage(){search.focus(),search.value="",counterObject.array=loopStorageItems().map((e=>createElem(e))),showStats()}function isStringAndNotEmpty(value){return"string"==typeof value&&""!==value.trim()}function loopLocalStorageSearch(){const searchValue=search.value.toLowerCase().trim();counterObject.counter=0,counterObject.array.forEach((entry=>{const{type:type,url:url,full:full,text:text}=entry.links;if(isStringAndNotEmpty(full)){const isInArray=[...type,...isStringAndNotEmpty(text)?[text]:[],...isStringAndNotEmpty(url)?[url]:[],full].some((value=>value.toLowerCase().includes(searchValue)));entry.className=isInArray?"link":"hidden",isInArray&&counterObject.counter++}})),showStats()}const saveData=(()=>{const a=d.createElement("a");return(data,fileName)=>{const json=JSON.stringify(data,null,2),blob=new Blob([json],{type:"application/json"}),url=URL.createObjectURL(blob);a.href=url,a.download=fileName,a.click(),URL.revokeObjectURL(url)}})();function readSingleFile(event){const file=event.target.files[0];if(!file)return;const reader=new FileReader;reader.onload=event=>{!function(data){try{const json=JSON.parse(data);if(Array.isArray(json)){const currentItems=StorageNamespace.getItem("url")||[];currentItems.push(...json),StorageNamespace.setItem("url",currentItems)}else console.warn("Parsed JSON is not an array:",json);for(hide(showExport);outputs.firstChild;)outputs.firstChild.remove();loopLocalStorage(),showStats()}catch(error){console.error("Error parsing JSON:",error)}}(event.target.result)},reader.readAsText(file)}let debounceTimeout;var callback,delay;exportJson.addEventListener("click",(()=>exporter())),checkedBoxElement.addEventListener("input",(()=>(()=>{const state=Boolean(checkedBoxElement.checked);body.classList.toggle("checks",state),StorageNamespace.setItem("admin-mode",state)})())),closeEx.addEventListener("click",(()=>hide(showExport))),closeBtn.addEventListener("click",(()=>hide(links))),opensBtn.addEventListener("click",(()=>hide(links))),createLink.addEventListener("click",(()=>setLinks())),copyAll.addEventListener("click",(e=>hide(showExport))),fileInput.addEventListener("change",(e=>readSingleFile(e)),!1),d.addEventListener("keydown",(e=>function(event){if(!event)return;const{key:key}=event;return"Enter"===key||active||search.focus(),event?.target.value.trim().length>1&&1===counterObject.counter&&outputs.querySelector("a:not(.hidden)").focus(),!1}(e)),!0),d.addEventListener("click",(e=>function(e){const isCreateLinkClicked="create-link"===e.target.id,isSelectClicked="select"===e.target.id;if(!isCreateLinkClicked)if(isSelectClicked&&!selection.classList.contains("open"))selection.classList.add("open"),checkboxes.style.display="block";else{if("LABEL"===e.target.tagName||"INPUT"===e.target.tagName)return;selection.classList.remove("open"),checkboxes.style.display="none",addTextOfChecked("")}}(e))),search.addEventListener("keyup",(callback=()=>loopLocalStorageSearch(),delay=200,(...args)=>{clearTimeout(debounceTimeout),debounceTimeout=setTimeout((()=>{callback(...args)}),delay)})),search.addEventListener("dblclick",(function(){0!==this.value.length&&(this.value="",loopLocalStorageSearch())})),loopLocalStorage()}(window,document);